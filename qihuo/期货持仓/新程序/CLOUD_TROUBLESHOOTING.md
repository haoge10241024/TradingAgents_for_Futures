# ☁️ Streamlit Cloud 故障排除指南

## 🚨 常见问题：数据获取失败

### 问题现象
```
⚠️ 大商所 数据获取失败，但不影响其他交易所
⚠️ 中金所 数据获取失败，但不影响其他交易所
⚠️ 上期所 数据获取失败，但不影响其他交易所
⚠️ 郑商所 数据获取失败，但不影响其他交易所
⚠️ 广期所 数据获取失败，但不影响其他交易所
❌ 分析失败，请检查网络连接或稍后重试
```

### 🔍 问题原因分析

#### 1. Streamlit Cloud网络限制
- **原因**: Streamlit Cloud对外部API访问有限制
- **表现**: 网络测试正常，但akshare数据获取失败
- **解决**: 使用演示模式或本地运行

#### 2. akshare API限制
- **原因**: akshare的数据源可能限制云端IP访问
- **表现**: 所有交易所数据都获取失败
- **解决**: 等待后重试或使用演示模式

#### 3. 请求频率限制
- **原因**: 短时间内请求过多被限制
- **表现**: 部分交易所成功，部分失败
- **解决**: 增加请求间隔，使用重试机制

#### 4. 数据源维护
- **原因**: 交易所数据源正在维护
- **表现**: 特定交易所数据获取失败
- **解决**: 选择其他日期或稍后重试

## ✅ 解决方案

### 方案1: 使用演示模式（推荐）
1. 在左侧边栏找到"🎭 运行模式"
2. 勾选"演示模式"
3. 点击"🚀 开始分析"
4. 系统将使用模拟数据展示所有功能

**优点**:
- 无需网络连接
- 功能完整体验
- 响应速度快
- 数据结构真实

### 方案2: 网络诊断和重试
1. 点击"🔍 网络诊断"查看详细信息
2. 等待5-10分钟后重试
3. 选择不同的交易日期
4. 使用"🌐 测试网络"确认连接状态

### 方案3: 本地运行
如果需要真实数据，建议本地运行：
```bash
git clone [您的仓库]
cd [项目目录]
pip install -r requirements.txt
streamlit run streamlit_app.py
```

## 🛠️ 技术细节

### 云端优化功能
系统已集成以下云端优化：

1. **智能重试机制**
   - 自动重试失败的请求
   - 指数退避策略
   - 特定错误处理

2. **请求间隔控制**
   - 避免请求过快被限制
   - 动态调整请求频率
   - 优化网络资源使用

3. **错误分类处理**
   - 超时错误：延长等待时间
   - 频率限制：增加重试间隔
   - 网络错误：切换请求策略

4. **备用数据源**
   - 演示数据生成
   - 缓存数据复用
   - 降级服务策略

### 演示模式说明
演示模式使用的是：
- **真实的数据结构**：与实际数据格式完全一致
- **合理的数值范围**：基于历史数据的合理模拟
- **完整的功能体验**：所有分析策略都可正常运行
- **确定性结果**：相同日期产生相同的演示数据

## 📊 性能对比

| 模式 | 数据获取时间 | 分析时间 | 网络依赖 | 功能完整性 |
|------|-------------|----------|----------|------------|
| 实时模式 | 1-5分钟 | 30秒 | 高 | 100% |
| 演示模式 | 5秒 | 30秒 | 无 | 100% |
| 缓存模式 | 10秒 | 30秒 | 低 | 100% |

## 🎯 使用建议

### 首次使用
1. **先尝试演示模式**：了解系统功能
2. **查看所有策略**：理解分析逻辑
3. **体验完整流程**：从数据到报告

### 日常使用
1. **优先使用实时模式**：获取最新数据
2. **失败时切换演示模式**：保证使用体验
3. **定期清理缓存**：保持系统性能

### 开发测试
1. **本地开发**：使用实时数据
2. **云端演示**：使用演示模式
3. **功能验证**：两种模式对比

## 🔧 故障排除步骤

### 步骤1: 基础检查
- [ ] 网络连接是否正常
- [ ] akshare是否正确安装
- [ ] Python版本是否为3.11
- [ ] 依赖包是否完整

### 步骤2: 模式切换
- [ ] 尝试演示模式
- [ ] 检查演示数据是否正常
- [ ] 验证分析功能是否正常

### 步骤3: 网络诊断
- [ ] 运行网络诊断功能
- [ ] 查看具体错误信息
- [ ] 记录失败的交易所

### 步骤4: 重试策略
- [ ] 等待5-10分钟后重试
- [ ] 选择不同日期测试
- [ ] 分别测试各个交易所

### 步骤5: 联系支持
如果问题持续存在：
- 提供网络诊断结果
- 描述具体错误信息
- 说明尝试过的解决方案
- 联系邮箱：953534947@qq.com

## 📞 技术支持

### 常见问题FAQ

**Q: 为什么网络测试正常但数据获取失败？**
A: Streamlit Cloud可能对特定API有访问限制，建议使用演示模式。

**Q: 演示模式的数据是否真实？**
A: 演示数据是基于真实数据结构的合理模拟，可以完整体验所有功能。

**Q: 如何获取真实的最新数据？**
A: 建议在本地环境运行系统，或等待云端网络限制解除。

**Q: 演示模式下的分析结果是否可信？**
A: 演示模式主要用于功能展示，分析逻辑是真实的，但数据是模拟的。

### 联系方式
- **邮箱**: 953534947@qq.com
- **问题反馈**: 请提供详细的错误信息和操作步骤
- **功能建议**: 欢迎提出改进建议

---

**通过演示模式，您可以完整体验系统的所有功能！** 🎭✨ 